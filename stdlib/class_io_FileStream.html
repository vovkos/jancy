

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>class io.FileStream &mdash; Jancy Standard Library Reference</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css?v=ff3f4257" />
      <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinx_rtd_theme.css?v=b6ca47bd" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5af6a172"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/target-highlight.js?v=df7d332b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="class io.Mailslot" href="class_io_Mailslot.html" />
    <link rel="prev" title="class io.File" href="class_io_File.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Jancy Standard Library Reference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="group_c-typedefs.html">Standard Typedefs</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_rtl.html">RTL (Runtime Library)</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_crt.html">C Runtime Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_std.html">General Purpose Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_sys.html">System Facilities</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="group_io.html">IO (Input/Output) Library</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="group_io-file.html">Generic File IO</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="enum_io_ChildProcessEvents.html">bitflag enum io.ChildProcessEvents</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_ChildProcessStartFlags.html">bitflag enum io.ChildProcessStartFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_FileKind.html">enum io.FileKind</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_FileOpenFlags.html">bitflag enum io.FileOpenFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_FileStreamEvents.html">bitflag enum io.FileStreamEvents</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_FileStreamOptions.html">bitflag enum io.FileStreamOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_NamedPipeEvents.html">bitflag enum io.NamedPipeEvents</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html">bitflag enum io.ReadOnlyStreamEvents</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_ReadOnlyStreamOptions.html">bitflag enum io.ReadOnlyStreamOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_StreamEvents.html">bitflag enum io.StreamEvents</a></li>
<li class="toctree-l3"><a class="reference internal" href="enum_io_StreamOptions.html">bitflag enum io.StreamOptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="struct_io_PtySize.html">struct io.PtySize</a></li>
<li class="toctree-l3"><a class="reference internal" href="class_io_ChildProcess.html">class io.ChildProcess</a></li>
<li class="toctree-l3"><a class="reference internal" href="class_io_File.html">class io.File</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">class io.FileStream</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detailed-documentation">Detailed Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="class_io_Mailslot.html">class io.Mailslot</a></li>
<li class="toctree-l3"><a class="reference internal" href="class_io_MappedFile.html">class io.MappedFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="class_io_NamedPipe.html">class io.NamedPipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_io-file.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="group_io-file.html#detailed-documentation">Detailed Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="group_io-socket.html">Socket Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-serial.html">Serial Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-network-adapter.html">Network Adapter Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-ssl.html">SSL Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-ssh.html">SSH Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-websock.html">WebSockets</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-pcap.html">Pcap (Packet Capturing Library)</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-usb.html">USB Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-usbmon.html">USB Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-hid.html">HID Communications</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_io-devmon.html">Device Monitoring</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="disposable.html">‘disposable’ Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="errorcode.html">‘errorcode’ Functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global.html">Global Namespace</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Jancy Standard Library Reference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="group_io.html">IO (Input/Output) Library</a></li>
          <li class="breadcrumb-item"><a href="group_io-file.html">Generic File IO</a></li>
      <li class="breadcrumb-item active">class io.FileStream</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="class-io-filestream">
<span id="doxid-type-io-filestream"></span><span id="index-0"></span><h1>class io.FileStream</h1>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>Overview</h2>
<p>This class provides high-level asynchronous streaming interface for
reading from and writing to files or devices. <a class="reference internal" href="#details-type-io-filestream"><span class="std std-ref">More…</span></a></p>
<pre class="highlight doxyrest-overview-code-block literal-block"><span></span><span class="k">import</span> <span class="s">&quot;io_base.jncx&quot;</span>
<span class="k">import</span> <span class="s">&quot;io_FileStream.jnc&quot;</span>

<span class="k">class</span> <span class="n">FileStream</span> <span class="p">{</span>
    <span class="c1">// fields</span>

    <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="k">readonly</span> <span class="k">volatile</span> <span class="doxyrest-code-target target" id="doxid-field-io-filestream-m-activeevents"><span></span><span class="n">m_activeEvents</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="struct_std_Error.html#doxid-type-std-error"><span class="std std-ref">std.Error</span></a><span></span> <span class="k">const</span><span class="o">*</span> <span class="k">readonly</span> <span class="k">volatile</span> <span class="doxyrest-code-target target" id="doxid-field-io-filestream-m-ioerror"><span></span><span class="n">m_ioError</span></span><span></span><span class="p">;</span>
    <span class="k">bool</span> <span class="k">readonly</span> <a class="reference internal" href="#doxid-field-io-filestream-m-isopen"><span class="std std-ref">m_isOpen</span></a><span></span><span class="p">;</span>

    <span class="c1">// properties</span>

    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-uint-t"><span class="std std-ref">uint_t</span></a><span></span> <span class="k">autoget</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-readparallelism"><span></span><span class="n">m_readParallelism</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">autoget</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-readblocksize"><span></span><span class="n">m_readBlockSize</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">autoget</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-readbuffersize"><span></span><span class="n">m_readBufferSize</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">autoget</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-writebuffersize"><span></span><span class="n">m_writeBufferSize</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="enum_io_FileStreamOptions.html#doxid-type-io-filestreamoptions"><span class="std std-ref">io.FileStreamOptions</span></a><span></span> <span class="k">autoget</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-options"><span></span><span class="n">m_options</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-uintptr-t"><span class="std std-ref">uintptr_t</span></a><span></span> <span class="k">const</span> <span class="k">property</span> <span class="doxyrest-code-target target" id="doxid-property-io-filestream-m-oshandle"><span></span><span class="n">m_osHandle</span></span><span></span><span class="p">;</span>
    <a class="reference internal" href="enum_io_FileKind.html#doxid-type-io-filekind"><span class="std std-ref">io.FileKind</span></a><span></span> <span class="k">const</span> <span class="k">property</span> <a class="reference internal" href="#doxid-property-io-filestream-m-kind"><span class="std std-ref">m_kind</span></a><span></span><span class="p">;</span>

    <span class="c1">// construction</span>

    <span class="doxyrest-code-target target" id="doxid-function-io-filestream-construct"><span></span><span class="k">construct</span></span><span></span><span class="p">();</span>
    <span class="doxyrest-code-target target" id="doxid-function-io-filestream-destruct"><span></span><span class="k">destruct</span></span><span></span><span class="p">();</span>

    <span class="c1">// methods</span>

    <span class="k">bool</span> <span class="k">errorcode</span> <a class="reference internal" href="#doxid-function-io-filestream-open"><span class="std std-ref">open</span></a><span></span><span class="p">(</span>
        <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-string-t"><span class="std std-ref">string_t</span></a><span></span> <span class="n">name</span><span class="p">,</span>
        <a class="reference internal" href="enum_io_FileOpenFlags.html#doxid-type-io-fileopenflags"><span class="std std-ref">io.FileOpenFlags</span></a><span></span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">);</span>

    <span class="k">void</span> <a class="reference internal" href="#doxid-function-io-filestream-close"><span class="std std-ref">close</span></a><span></span><span class="p">();</span>
    <span class="k">void</span> <a class="reference internal" href="#doxid-function-io-filestream-unsuspend"><span class="std std-ref">unsuspend</span></a><span></span><span class="p">();</span>
    <span class="k">bool</span> <span class="k">errorcode</span> <a class="reference internal" href="#doxid-function-io-filestream-clear"><span class="std std-ref">clear</span></a><span></span><span class="p">();</span>

    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">errorcode</span> <a class="reference internal" href="#doxid-function-io-filestream-read"><span class="std std-ref">read</span></a><span></span><span class="p">(</span>
        <span class="k">void</span><span class="o">*</span> <span class="n">p</span><span class="p">,</span>
        <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="n">size</span>
    <span class="p">);</span>

    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">errorcode</span> <a class="reference internal" href="#doxid-function-io-filestream-write"><span class="std std-ref">write</span></a><span></span><span class="p">(</span>
        <span class="k">void</span> <span class="k">const</span><span class="o">*</span> <span class="n">p</span><span class="p">,</span>
        <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="n">size</span>
    <span class="p">);</span>

    <span class="k">long</span> <span class="k">errorcode</span> <span class="doxyrest-code-target target" id="doxid-function-io-filestream-wait"><span></span><span class="n">wait</span></span><span></span><span class="p">(</span>
        <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">eventMask</span><span class="p">,</span>
        <span class="k">void</span> <span class="k">function</span><span class="o">*</span> <span class="n">handler</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">FileStreamEvents</span> <span class="n">triggeredEvents</span><span class="p">)</span>
    <span class="p">);</span>

    <span class="k">bool</span> <span class="k">errorcode</span> <span class="doxyrest-code-target target" id="doxid-function-io-filestream-cancelwait"><span></span><span class="n">cancelWait</span></span><span></span><span class="p">(</span><span class="k">long</span> <span class="n">handle</span><span class="p">);</span>

    <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="doxyrest-code-target target" id="doxid-function-io-filestream-blockingwait"><span></span><span class="n">blockingWait</span></span><span></span><span class="p">(</span>
        <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">eventMask</span><span class="p">,</span>
        <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-uint-t"><span class="std std-ref">uint_t</span></a><span></span> <span class="n">timeout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="p">);</span>

    <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="k">async</span> <span class="doxyrest-code-target target" id="doxid-function-io-filestream-asyncwait"><span></span><span class="n">asyncWait</span></span><span></span><span class="p">(</span><a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">eventMask</span><span class="p">);</span>

    <span class="c1">// aliases</span>

    <span class="k">alias</span> <a class="reference internal" href="#doxid-alias-io-filestream-dispose"><span class="std std-ref">dispose</span></a><span></span> <span class="o">=</span> <span class="n">close</span><span class="p">;</span>
<span class="p">};</span></pre>
</section>
<section id="detailed-documentation">
<span id="details-type-io-filestream"></span><h2>Detailed Documentation</h2>
<p>This class provides high-level asynchronous streaming interface for
reading from and writing to files or devices.</p>
<p>Besides all the standard methods of <code class="docutils literal notranslate"><span class="pre">io.File</span></code> (like <code class="docutils literal notranslate"><span class="pre">open</span></code>, <code class="docutils literal notranslate"><span class="pre">read</span></code>,
<code class="docutils literal notranslate"><span class="pre">write</span></code> etc) <code class="docutils literal notranslate"><span class="pre">io.FileStream</span></code> also notifies its clients of events occured
on this file stream such as when data has arrived and could be read or when
IO error occured. This allows for clean and convenient asynchronous
event-driven IO programming.</p>
<p>A typical sequence of steps when working with a file stream looks something
like this:</p>
<ul class="simple">
<li><p>Open a file stream with <code class="docutils literal notranslate"><span class="pre">open</span></code> method;</p></li>
<li><p>Assign IO event handler with <code class="docutils literal notranslate"><span class="pre">wait</span></code> method. You would probably also
want to <em>schedule</em> your event handler to be run in particular
environment(e.g., in a specific thread) and partially apply some
syncrhonization ID to discard late events;</p></li>
<li><p>When <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html#doxid-enum-member-io-readonlystreamevents-incomingdata"><span class="std std-ref"><span class="pre">io.FileStreamEvents.IncomingData</span></span></a></code> event is fired, read from the file
using <code class="docutils literal notranslate"><span class="pre">read</span></code> method;</p></li>
<li><p>Write to the file stream using <code class="docutils literal notranslate"><span class="pre">write</span></code> method;</p></li>
<li><p>Suspend writing if the return value of <code class="docutils literal notranslate"><span class="pre">write</span></code> is less than requested;</p></li>
<li><p>Resume writing on <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="enum_io_StreamEvents.html#doxid-enum-member-io-streamevents-writebufferready"><span class="std std-ref"><span class="pre">io.FileStreamEvents.WriteBufferReady</span></span></a></code> event;</p></li>
<li><p>Close the file stream when no longer needed with <code class="docutils literal notranslate"><span class="pre">close</span></code> method.</p></li>
</ul>
<p class="rubric">Sample code:</p>
<pre class="highlight literal-block"><span></span><span class="k">class</span> <span class="n">MyDialog</span> <span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="n">io</span><span class="p">.</span><span class="n">FileStream</span> <span class="n">m_fileStream</span><span class="p">;</span>
    <span class="n">uint_t</span> <span class="n">m_syncId</span><span class="p">;</span>

    <span class="k">void</span> <span class="n">open</span><span class="p">(</span><span class="n">string_t</span> <span class="n">fileName</span><span class="p">);</span>
    <span class="k">void</span> <span class="n">close</span><span class="p">();</span>
    <span class="k">void</span> <span class="n">waitFileStreamEvents</span><span class="p">();</span>

    <span class="k">void</span> <span class="n">onWriteButtonClicked</span><span class="p">();</span>

    <span class="k">void</span> <span class="n">onFileStreamEvent</span><span class="p">(</span>
        <span class="n">uint_t</span> <span class="n">syncId</span><span class="p">,</span>
        <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">triggeredEvents</span>
    <span class="p">);</span>
<span class="p">}</span>

<span class="n">MyDialog</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">string_t</span> <span class="n">fileName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="k">try</span> <span class="n">m_fileStream</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">string_t</span> <span class="n">errorString</span> <span class="o">=</span> <span class="n">std</span><span class="p">.</span><span class="n">getLastError</span><span class="p">().</span><span class="n">m_description</span><span class="p">;</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="n">waitFileStreamEvents</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">MyDialog</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">m_fileStream</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="n">m_syncId</span><span class="o">++</span><span class="p">;</span> <span class="c1">// events past this point will be discarded as &#39;late&#39;</span>
<span class="p">}</span>

<span class="n">MyDialog</span><span class="p">.</span><span class="n">waitFileStreamEvent</span><span class="p">()</span> <span class="p">{</span>
    <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">eventMask</span> <span class="o">=</span>
        <a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html#doxid-enum-member-io-readonlystreamevents-ioerror"><span class="std std-ref">io.FileStreamEvents.IoError</span></a><span></span> <span class="o">|</span>
        <a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html#doxid-enum-member-io-readonlystreamevents-incomingdata"><span class="std std-ref">io.FileStreamEvents.IncomingData</span></a><span></span><span class="p">;</span>

    <span class="n">m_fileStream</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">eventMask</span><span class="p">,</span> <span class="n">onFileStreamEvent</span> <span class="o">~</span><span class="p">(</span><span class="o">++</span><span class="n">m_syncId</span><span class="p">)</span> <span class="o">@</span>
        <span class="n">g_mainThreadScheduler</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MyDialog</span><span class="p">.</span><span class="n">onWriteButtonClicked</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">char</span> <span class="n">data</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;a quick brown fox jumps over the lazy dog&quot;</span><span class="p">;</span>
    <span class="n">m_fileStream</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">MyDialog</span><span class="p">.</span><span class="n">onFileStreamEvent</span><span class="p">(</span>
    <span class="n">uint_t</span> <span class="n">syncId</span><span class="p">,</span>
    <a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref">io.FileStreamEvents</span></a><span></span> <span class="n">triggeredEvents</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">syncId</span> <span class="o">!=</span> <span class="n">m_syncId</span><span class="p">)</span> <span class="c1">// late event</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">triggeredEvents</span> <span class="o">&amp;</span> <a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html#doxid-enum-member-io-readonlystreamevents-ioerror"><span class="std std-ref">io.FileStreamEvents.IoError</span></a><span></span><span class="p">)</span> <span class="p">{</span>
        <span class="n">string_t</span> <span class="n">errorString</span> <span class="o">=</span> <span class="n">m_fileStream</span><span class="p">.</span><span class="n">m_ioError</span><span class="p">.</span><span class="n">m_description</span><span class="p">;</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">triggeredEvents</span> <span class="o">&amp;</span> <a class="reference internal" href="enum_io_ReadOnlyStreamEvents.html#doxid-enum-member-io-readonlystreamevents-incomingdata"><span class="std std-ref">io.FileStreamEvents.IncomingData</span></a><span></span><span class="p">)</span> <span class="p">{</span>
        <span class="k">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
        <span class="n">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="n">m_fileStream</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">));</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="n">waitFileStreamEvents</span><span class="p">();</span> <span class="c1">// restart wait</span>
<span class="p">}</span></pre>
<p class="rubric">See also:</p>
<p><code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="enum_io_FileStreamEvents.html#doxid-type-io-filestreamevents"><span class="std std-ref"><span class="pre">io.FileStreamEvents</span></span></a></code>, <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="class_io_File.html#doxid-type-io-file"><span class="std std-ref"><span class="pre">io.File</span></span></a></code>, <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="class_io_NamedPipe.html#doxid-type-io-namedpipe"><span class="std std-ref"><span class="pre">io.NamedPipe</span></span></a></code>, <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="class_io_Mailslot.html#doxid-type-io-mailslot"><span class="std std-ref"><span class="pre">io.Mailslot</span></span></a></code></p>
<section id="fields">
<h3>Fields</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-field-io-filestream-m-isopen"><span id="index-1"></span><span></span><span class="k">bool</span> <span class="k">readonly</span> <span class="n">m_isOpen</span></pre>
<p>Holds the open status for the file stream, i.e. <code class="docutils literal notranslate"><span class="pre">true</span></code> if opened;
<code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise.</p>
</section>
<section id="properties">
<h3>Properties</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-property-io-filestream-m-kind"><span id="index-2"></span><a class="reference internal" href="enum_io_FileKind.html#doxid-type-io-filekind"><span class="std std-ref">io.FileKind</span></a><span></span> <span class="k">const</span> <span class="k">property</span> <span class="n">m_kind</span></pre>
<p>Specifies the type of the file stream(regular disk file, serial port
etc). For the full list of supported file stream types, refer to
<code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="enum_io_FileKind.html#doxid-type-io-filekind"><span class="std std-ref"><span class="pre">io.FileKind</span></span></a></code>.</p>
<p>This field is currently only initialized on Windows. To to detect the
type <code class="docutils literal notranslate"><span class="pre">io.FileStream</span></code> uses WinAPI function <code class="docutils literal notranslate"><span class="pre">GetFileType</span></code>.</p>
</section>
<section id="methods">
<h3>Methods</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-open"><span id="index-3"></span><span></span><span class="k">bool</span> <span class="k">errorcode</span> <span class="n">open</span><span class="p">(</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-string-t"><span class="std std-ref">string_t</span></a><span></span> <span class="n">name</span><span class="p">,</span>
    <a class="reference internal" href="enum_io_FileOpenFlags.html#doxid-type-io-fileopenflags"><span class="std std-ref">io.FileOpenFlags</span></a><span></span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span></pre>
<p>Opens or creates a file stream.</p>
<p>The function accepts two arguments. The first one, <code class="docutils literal notranslate"><span class="pre">name</span></code> specifies
the name of the file/device. The second one, <code class="docutils literal notranslate"><span class="pre">flags</span></code>, can be used to
specify open options. Check <code class="doxyrest-cref docutils literal notranslate"><a class="reference internal" href="enum_io_FileOpenFlags.html#doxid-type-io-fileopenflags"><span class="std std-ref"><span class="pre">io.FileOpenFlags</span></span></a></code> for the complete list of
options.</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> on success. If the file stream could not be opened, IO
error supplied by operating system is set and then the function returns
<code class="docutils literal notranslate"><span class="pre">false</span></code> <a class="footnote-reference superscript" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-close"><span id="index-4"></span><span></span><span class="k">void</span> <span class="n">close</span><span class="p">()</span></pre>
<p>Closes a previously opened file stream, does nothing if the file stream
is not opened. This function always succeeds.</p>
<p>Sometimes it may be convenient to use <em>disposable</em> pattern to ensure
timely invokation of <code class="docutils literal notranslate"><span class="pre">close</span></code> <a class="footnote-reference superscript" href="#f2" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-unsuspend"><span id="index-5"></span><span></span><span class="k">void</span> <span class="n">unsuspend</span><span class="p">()</span></pre>
<p>Accepted named pipes may initially be suspended (so that the user has
a chance to configure reading options such as <code class="docutils literal notranslate"><span class="pre">m_readBlockSize</span></code>)</p>
<p>Call <code class="docutils literal notranslate"><span class="pre">start</span></code> to awaken the accepted pipe after it has been
configured.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-clear"><span id="index-6"></span><span></span><span class="k">bool</span> <span class="k">errorcode</span> <span class="n">clear</span><span class="p">()</span></pre>
<p>Clears the file, destroying all its contents. This function is only
applicable to regular disk file streams.</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">true</span></code> on success. If clear operation is unsuccessful, IO
error supplied by the operating system is set and then the function
returns <code class="docutils literal notranslate"><span class="pre">false</span></code> <a class="footnote-reference superscript" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-read"><span id="index-7"></span><a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">errorcode</span> <span class="n">read</span><span class="p">(</span>
    <span class="k">void</span><span class="o">*</span> <span class="n">p</span><span class="p">,</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Attempts to read up to <code class="docutils literal notranslate"><span class="pre">size</span></code> bytes from the file strean into the
buffer pointed to by <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<p>Returns the actual amount of bytes read on success. If read operation
is unsuccessful, IO error supplied by the operating system is set and
then the function returns <code class="docutils literal notranslate"><span class="pre">-1</span></code> <a class="footnote-reference superscript" href="#f1" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>Normally you would call this function from within your event handler
for <code class="docutils literal notranslate"><span class="pre">IncomingData</span></code> event. If this function is called when there is
no incoming data, it blocks until either the data arrives, or the file
is closed.</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-function-io-filestream-write"><span id="index-8"></span><a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="k">errorcode</span> <span class="n">write</span><span class="p">(</span>
    <span class="k">void</span> <span class="k">const</span><span class="o">*</span> <span class="n">p</span><span class="p">,</span>
    <a class="reference internal" href="group_c-typedefs.html#doxid-typedef-size-t"><span class="std std-ref">size_t</span></a><span></span> <span class="n">size</span>
<span class="p">)</span></pre>
<p>Attempts to write <code class="docutils literal notranslate"><span class="pre">size</span></code> bytes from the buffer pointed to by <code class="docutils literal notranslate"><span class="pre">p</span></code>
into the file stream.</p>
<p>Returns the actual amount of bytes written on success. If write
operation is unsuccessful, IO error supplied by the operating system
is set and then the function returns <code class="docutils literal notranslate"><span class="pre">-1</span></code> <a class="footnote-reference superscript" href="#f1" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>If the return value shows <em>less</em> bytes than specified by <code class="docutils literal notranslate"><span class="pre">size</span></code>
argument, you should suspend further transmission until the file stream
is ready to accept more data. When this happens, <code class="docutils literal notranslate"><span class="pre">WriteBufferReady</span></code>
event is fired and transmission could be resumed.</p>
</section>
<section id="aliases">
<h3>Aliases</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-alias-io-filestream-dispose"><span id="index-9"></span><span></span><span class="k">alias</span> <span class="n">dispose</span> <span class="o">=</span> <span class="n">close</span></pre>
<p>Effectively makes <code class="docutils literal notranslate"><span class="pre">io.FileStream</span></code> a <em>disposable</em> class <a class="footnote-reference superscript" href="#f2" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<aside class="footnote-list superscript">
<aside class="footnote superscript" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>You can use exception semantics to handle the erroneous return values of <code class="docutils literal notranslate"><span class="pre">errorcode</span></code> functions. For more details refer to <a class="reference internal" href="errorcode.html#errorcode"><span class="std std-ref">‘errorcode’ Functions</span></a>.</p>
</aside>
<aside class="footnote superscript" id="f2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>You can ensure timely release of resources by using <em>disposable</em> pattern. For more details refer to <a class="reference internal" href="disposable.html#disposable"><span class="std std-ref">‘disposable’ Variables</span></a>.</p>
</aside>
</aside>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="class_io_File.html" class="btn btn-neutral float-left" title="class io.File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="class_io_Mailslot.html" class="btn btn-neutral float-right" title="class io.Mailslot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Tibbo Technology Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>